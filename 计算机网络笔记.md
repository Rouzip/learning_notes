# **计算机网络笔记**




## 第一章 计算机网络和互联网

###**因特网的定义**：
1. 我们能够描述因特网的具体构成，即构成因特网的基本硬件和软件组成。2.我们能够根据为分布式应用提供服务的联网基础设施来描述互联网。（是网络与网络之间所串连成的庞大网络，这些网络以一组标准的网络TCP/IP协议族相连，连接全世界几十亿个设备，形成逻辑上的单一巨大国际网络。）

按照地理位置划分为局域网、城域网、广域网和互联网。

---

###**网络协议的定义**：
在因特网中，凡是涉及两个或多个远程通信实体的所有活动都受协议的制约。一个协议定义了在两个或多个通信实体之间的交换报文格式和次序，以及报文发送和/或接受一条报文或者其他时间所采取的动作。

---

###**物理介质**：
双绞铜线，同轴电缆，光纤，陆地无线信道，卫星无线信道

---


###**两种基本的交换方法**：
电路交换与分组交换

>**电路交换**：在端系统间通信会话期间，预留了端系统间通信沿路径所需要的资源（缓存，链路传输速率）。【频分复用FDM（Frequency-Division Multiplexing），时分复用TDM（Time-Division Multiplexing）】（优势：便于实时服务）

>**分组交换**：为了从源端系统向目的端系统发送一个报文，源将长报文划分为较小的数据块，称之为分组（优势：一个系统可以将数据组装到报文中使用一条通信链路与多台机器通信。不仅链路是可以共享的，而且每个报文可以独立于其他报文进行路由。这是分组交换最主要的优势。）

---

###**时延的种类**：
结点处理时延，排队时延，传输时延，传播时延
>传播延时与传输延时的区别：传输时延是路由器将分组推出所需要的时间，传播时延是一个比特从一台路由器向另一台路由器传播所需要的时间

---

###**端到端延时公式**：

$d_{end-end} = N(d_{proc} + d_{trans} + d_{prop})$

>proc为处理时延，prop为每条链路的传播时延

---

###**计算机网络分层**：
| 五层因特网协议栈 |
| :------: |
|   应用层    |
|   传输层    |
|   网络层    |
|   链路层    |
|   物理层    |

---

| 七层ISO OSI参考模型                            |
| ---------------------------------------- |
| 应用层：应用层直接面向用户应用，为用户提供对各种网络资源的方便的访问服务。    |
| 表示层：表示层定义用户或应用程序之间交换数据的格式，提供数据表示之间的转换服务，保证传输的信息到达目的端后意义不变。 |
| 会话层：会话层在传输层服务的基础上增加控制会话的机制，建立、组织和协调应用进程之间的交互过程。会话层提供的会话服务种类包括双工、半双工和单工方式。会话管理的一种方式是令牌管理，只有令牌持有者才能执行某种操作。会话层提供会话的同步控制，当出现故障时，会话活动在故障点之前的同步点进行重复，而不必从头开始。 |
| 传输层：传输层传输的PDU称为报文（message） segment，传输层为源结点和目的结点的用户进程之间提供端到端的可靠的传输服务。端到端的传输指的是源结点和目的结点的两个传输层实体之间，不涉及路由器等中间结点。为了保证可靠的传输服务，传输层具备以下一些功能：面向连接、流量控制与拥塞控制、差错控制和网络服务质量的选择等。 |
| 网络层：网络层传送的PDU称为分组或包（packet），在物理网络间传送分组，负责将源端主机的报文通过中间转发结点传送到目的端。网络层是通信子网的最高层，为主机提供虚电路和数据报两种方式的服务。网络层主要负责分组转发和路由选择，根据路由表把分组逐跳地由源站传送到目的站，并能适应网络的负载及拓扑结构的变化，动态地更新路由表。 |
| 链路层：数据链路层负责在单个链路上的结点间传送以帧（frame）为PDU的数据，在不太可靠的物理链路上实现可靠的数据传输。数据链路层的主要功能包括：建立、维持和释放数据链路的连接；链路的访问控制、流量控制和差错控制。 |
| 物理层：物理层所处理的数据单位是比特（bit），物理层向上为数据链路层提供物理链路，实现透明的比特流（bit stream）传输服务，物理层向下与物理媒体相连，要确定连接物理媒体的网络接口的机械、电气、功能和过程方面的特性。 |

---

###**计算机网络分层的意义**：

1. 人们可以很容易地学习和讨论协议的规范细节
2. 层间的标准接口方便了工程模块化
3. 创建了一个更好的互联环境
4. 降低了复杂度，使程序容易修改，产品能开发的速度更快
5. 每层利用紧邻的下层服务，更容易记住各层的功能

---

应用层协议：HTTP,FTP,SMTP,DNS(域名系统),P2P(对等式网络),TELNET(远程登录),RIP(路由选择信息协议),BGP(边界网关协议)

传输层协议：TCP(传输控制协议),UDP(用户数据报协议)

两者之间：ICMP,OSPF(开放最短路优先)

网络层协议：IP

两者之间：DHCP(动态主机设置协议),ARP(地址解析协议)

链路层协议：以太网，令牌环，ATM

物理层：线路，无线电，光纤

---

## 第二章 应用层

###**DNS**：
DNS是应用层协议。其提供如下服务：1. 主机别名 2. 邮箱服务器别名 3. 负载分配
寻找IP地址：名字可以映射多个地址，也可以多个名字映射一个地址。
1. 维护host.txt（太大，并且维护麻烦）
2. 分布式管理
3. Domain Name System（DNS）
>DNS构造为层次模型。
>域名系统的命名规则。
>按照BFS算法进行查询，递归查询，迭代查询。
>DNS系统还会有缓存，但是具有存活时间。
---

### **HTTP**

POST,GET,PUT等服务

http请求报文

![](https://raw.githubusercontent.com/Rouzip/learning_notes/master/PICTURES/http%E8%AF%B7%E6%B1%82%E6%8A%A5%E6%96%87%E6%A0%BC%E5%BC%8F.png)

http回复报文

![](https://raw.githubusercontent.com/Rouzip/learning_notes/master/PICTURES/http%E5%9B%9E%E5%A4%8D%E6%8A%A5%E6%96%87%E6%A0%BC%E5%BC%8F.png)

---

## 第三章 运输层

###**IP协议**:
IP的服务模型为尽力而为交付服务，它不保证报文段的交付，不保证报文段的按序交付，不保证报文段中数据的完整性。

---

将运输层报文段中的数据交付到正确的套接字的工作称为**多路分解**。在源主机从不同套接字中收集数据块，并为每个数据块封装上首部信息（这将在以后用于分解）从而生成报文段，然后将报文段传递到网络层，所有这些工作成为**多路复用**。

UDP只是做了运输协议能够做的最少工作，除了复用/分解功能及少量的差错检测，没对IP添加任何东西。
>**UDP应用特点**:
>1.关于何时、发送什么数据的应用层控制更为精细
>2.无需建立连接
>3.无连接状态
>4.分组首部开销小

UDP在IP的基础之上添加了端口的功能。

---

###**具有比特差错的丢包信道的可靠数据传输**:
收到之后回复ACK或者NAK（自动重传请求ARQ协议），在发送方和接收方的信道之中同时引入冗余数据分组，为了实现基于时间的重传机制，需要一个倒计数计时器，为了充分使用链路，同时引入流水线技术。对于解决流水线的差错恢复有两种基本办法：**回退N步（GBN）**和**选择重传（SR）**
>**GBN**:滑动窗口协议。图在书150页
>**发送方**：我们将基序号定义为最早的未确认分组的序号，将下一个序号定义为最小的未使用序号，则可将序号范围分割成四段。在【0，base-1】段内的序号对应于已经发送并被确认的分组。【base，nextseqnum-1】段内对应已经发送但未被确认的分组。【nextseqnum，base+N-1】段内的序号能用于那些要被立即发送的分组，如果有数据来自于上层的话。最后，大于或等于base+N的序号是不能使用的，直到当前流水线中未被确认的分组已得到确认为止。
>N被称作**窗口长度**
>**需要响应的三种类型事件**：1.上层的调用 2.收到一个ACK 3.超时事件
>**接收方**：如果一个序号为n的分组被正确接收到，并且按序，则接受方为分组n发送一个ACK，并将该分组中的数据部分交付到上层。在所有其他情况下，接受方丢弃该分组，并为最近按序接受的分组重新发送ACK。


>**SR**:让发送方仅重传送那些它怀疑在接收方出错的分组而避免了不必要的重传。SR接收方将确认一个正确接受的分组而不管其是否按序。失序的分组将被缓存直到所有丢失分组皆被收到为止，这时才可以将一批分组按序交付给上层。（窗口长度必须小于或等于序号空间大小的一半）。图在书151，152页

---

###**流量控制**
发送主机必须保证 : $LastByteSent - LastByteAcked≤rwnd$

---

###**TCP连接建立**
第一步：客户端的TCP发送SYN为１的特殊报文，其中客户会选择一个初始序列号，放置在起始的TCP SYN报文的序列字段中。
第二步：服务器抽取TCP SYN报文段，为TCP连接分配资源，并发送允许连接的接受报文。首部SYN置为１，确认字段被置为client_isn+1，最后服务器选择自己的初始序列号server_isn，并将其放置到TCP报文段首部的序号字段中。该报文有时被称作SYNACK报文段。
第三部：客户为连接分配资源，客户发送报文段，将server_isn+1放置在TCP报文的首部确认字段。，将SYN比特设置为０。
![](https://raw.githubusercontent.com/Rouzip/learning_notes/master/PICTURES/%E8%AE%A1%E7%BD%91%E7%AC%94%E8%AE%B01.png)

---

###**TCP连接拆除**
![TCP拆除](https://raw.githubusercontent.com/Rouzip/learning_notes/master/PICTURES/%E8%AE%A1%E7%BD%91%E7%AC%94%E8%AE%B02.png)
客户应用进程发送FIN为1的报文，当服务器收到该报文的时候，向发送方回送一个确认报文，然后发送自己的终止报文段，其FIN设置为1，最后，客户对该报文进行确认。

---

###**TCP的拥塞控制**
>TCP必须使用端到端的拥塞控制而不是使用网络辅助的拥塞控制，因为IP层不向端系统提供显式的网络拥塞反馈。

TCP的拥塞控制主要原理依赖于一个拥塞窗口(cwnd)来控制。由于需要考虑拥塞控制和流量控制两个方面的内容，因此TCP的真正的发送窗口=min(rwnd, cwnd)。但是rwnd是由对端确定的，网络环境对其没有影响，所以在考虑拥塞的时候我们一般不考虑rwnd的值，我们暂时只讨论如何确定cwnd值的大小。

---

### **可靠数据传输机制及其用途的总结** 
|   机制   | 用途和说明                                    |
| :----: | ---------------------------------------- |
|  效验和   | 用于检测在一个传输分组中的比特错误                        |
|  定时器   | 用于超时/重传一个分组，可能因为该分组（或其ACK）在信道中丢失了。由于当一个分组延时但未丢失（过早超时），或当一个分组已被接受方收到但从接收方的ACK丢失时，可能产生超时事件，所以接收方可能会受到一个分组的的多个冗余副本 |
|   序号   | 用于为从发送方流向接收方的数据分组按顺序编号。所接受分组的序号间的空隙可使接收方检测出丢失的分组。具有相同序号的分组可使接收方检测出一个分组的冗余副本 |
|   确认   | 接收方用于告诉发送方一个分组或一组分组已被正确地接收到了。确认报文通常携带着被确认的分组或多个分组的序号。确认可以是逐个的或积累的，这取决于协议 |
|  否定确认  | 接收方用于高速发送方某个分组未被正确地接受。否定确认报文通常携带着未被正确接受的分组的序号 |
| 窗口、流水线 | 发送方也许被限制仅发送那些序号落在一个指定范围的分组。通过允许一次发送多个分组但未被确认，发送方的利用率可在停等操作模式的基础上得到增加。 |

---

###**估计往返时间**：

$EstimatedRTT = 0.875*EstimatedRTT + 0.125*SampleRTT$

**偏移RTT**：$DevRTT = (1-β)*DevRTT + β*|SampleRTT - EstimatedRTT|$
**超时重传**：$TimeoutInterval = EstimatedRTT + 4*DevRTT$

---

###**流量管理**：
发送方维护一个接受窗口提供流量控制。
$$LastByteSend - LastByteAcked ≤ min\{cwnd(拥塞窗口), rwnd(接收窗口)\}$$


>推荐的初始TimeoutInterval值为１秒，超时发生的时候，TimeoutInterval的值会加倍（以免即将被确认的后继报文段过早出现超时）

---

###**TCP**:
TCP经过三次握手建立连接。[TCP链接建立与拆除][1]
>**TCP拥塞控制**：（原因：TCP必须使用端到端拥塞控制而不是网络辅助的拥塞控制，因为IP层不向端系统提供显式的网络拥塞反馈。）
>*拥塞控制原理*：
1. 慢启动
  初值设置为较小的MSS，cwnd初值设置为1，并以指数增战。当存在一个由超时指示的丢包事件，将cwnd设置为1，并将ssthresh设置为拥塞窗口值的一半。慢启动结束的第二种方式是直接与ssrhresh的值相关联。因为当检测到拥塞时ssthresh设置为cwnd的值一半，当到达或超过ssthresh的值时，结束慢启动，进入拥塞避免模式。最后一种结束慢启动的方式是，如果检测到三个冗余ACK，执行快速重传。
2. 拥塞避免
  每个RTT只将cwnd的值增加一个MSS。当出现超时的是时候，ssthresh的值被更新为cwnd值的一半，或者由三个冗余ACK事件触发，进入快速恢复状态。
3. 快速恢复
  对于引起TCP进入快速恢复状态的缺失报文段，对收到的每个冗余的ACK，cwnd的值增加一个MSS。最终，当对丢失报文段的一个ACK到达时，TCP在降低cwnd后进入拥塞避免状态。如果出现超时时间，快速恢复在执行如同在慢启动和拥塞避免中相同的动作，迁移到慢启动状态：当丢包事件出现时，cwnd的值被设置为1个MSS，并且ssthresh的值设置为cwnd值的一半。（使用累积确认原则）

![](https://raw.githubusercontent.com/Rouzip/learning_notes/master/PICTURES/TCP.jpg)

---

### **TCP计时管理器**

TCP共使用以下四种计时器，即重传计时器、坚持计时器、保活计时器和时间等待计时器 。

重传计时器：两个rtt

坚持计数器：收到零窗口确认时候设置

保活计数器：通常意义上的心跳保持

时间等待计数器：结束的时候的计数器

---

### **DUPACK**

例子：

![dupack](https://raw.githubusercontent.com/Rouzip/learning_notes/master/PICTURES/dupack.png)

---

###**减少傻瓜窗口**：

目的为了减少overhead of small packet（缓存小数据）
**delayed ACK**不立刻发送ACK，等待一段时间，将一段时间内的ACK合并，一起携带在有效数据进行传输。

---

###**Cheating TCP**
即不减半发送的信息，使得网络阻塞，自己享有全部的带宽。
>IPV4目前无法区分流，无法解决。

初始的cwnd很大。
建立很多连接（Dos？）

---

###**随机早期丢弃（RED）**
重要参数：MinThresh MaxThresh
早期随机丢包，防止后期丢弃大量包。

ECN：$>max$打标记,$min<当前<max$，几率打标记，不丢弃，但是返回带标记的ACK
路由器的显示反馈

---

目标：定义公式，计算出rate（探测法的利用率不高）

---

### **UDP**

对于要求不高，且要求速度较快的时候使用UDP

![UDP](https://raw.githubusercontent.com/Rouzip/learning_notes/master/PICTURES/UDP.jpg)

---


## 第四章 网络层

### **数据报模式和虚电路模式**

转发是指将分组从一个输入链路接口转移到适当的输出链路接口的路由器本地动作。路由选择是指将网络范围的过程已决定分组从源到目的地所采取的端到端路径。
网络层提供的服务：确保交付，具有时延上界的确保交付，有序分组交付，确保最小带宽，确保最大时延抖动，安全性服务。
仅在网络层提供连接服务的计算机网络称为虚电路网路，仅在网络层提供无连接服务的计算机网络称为数据报网络。

---

###**路由器的四个组成部分**：
输入端口，交换结构，输出端口，路由选择处理器

---

协议号是将网络层与运输层绑定到一起的粘合剂，而端口号是将运输层和应用层绑定到一起的粘合剂。
>当一台目的主机从相同的源收到一系列数据报时，他需要确定这些数据报中的某些是否是一些原来较大的数据报的片。如果某些数据包是片的话，则它必须进一步确定何时收到了最后一片，并且如何将这些受到的片拼接到一起以形成初始的数据报。（使用偏移和标志还有ID一起来确认，最后一个片的标志比特被设为0，其他的为1。使用偏移字段指定该片应当放在初始IP数据报的哪个位置）

---

###**IPV4编址**：
每个IP地址长度为32比特，使用点分十进制记法。后面可附带子网掩码（/24），（*分类编址*：具有8,16,24比特子网地址的子网分别被称作A、B和C类网络。

ipv4报文格式

![ipv4](https://raw.githubusercontent.com/Rouzip/learning_notes/master/PICTURES/ipv4.png)

---

### **DHCP**

>获取主机地址：动态主机配置协议（*DHCP*）
1. DHCP服务器发现：使用DHCP发现报文来完成，boardcast报文
2. DHCP服务器提供：服务器boardcast，提供发现报文的事务ID，向客户推荐的IP地址，使用时间，子网掩码等（boardcast的作用：因为在子网中可能有几个DHCP服务器，该客户也许会发现它处于几个提供者之间进行选择的优越位置）
3. DHCP请求：选择其中的一个，向其发送一个DHCP请求报文，回显配置参数
4. DHCP ACK：服务器对于报文进行响应，证实所要求的参数。

---

###**NAT**：
网络地址转换，将内部世界转化为一个网络，但是对于外部世界来说，NAT路由器对外界的行为就如同一个具有单一IP地址的单一设备。使用NAT路由器上的一张NAT转环表，并且在表项中包含了端口号及其IP地址。

---

###**ICMP**：
因特网控制报文协议，其承载在IP之上。当一个主机收到一个指明上层协议为ICMP的IP数据报时，他分解出该数据报的内容给ICMP（类似TCP和UDP）。

![icmp](https://raw.githubusercontent.com/Rouzip/learning_notes/master/PICTURES/icmp.jpg)

---

###**IPV6**：
具有流标签和优先级，IPV6不允许在中间路由器上进行分片和重新组装。这种操作只能在源与目的地上执行，取消首部效验和。
使用**隧道**使得IPV4和IPV6之间进行通信。

---

###**路由选择算法**：
链路状态算法（LS），距离向量算法（DV）
>**LS算法（Dijkstra）**：
>1. 在初始化步骤，从自己到与其直接相连接的邻居的当前已知最低费用路径分别初始化为。
>2. 在第一次迭代中，我们观察那些还未加到集合N'中的结点，并且找出在前一次迭代结束时具有最低费用的结点。
>3. 如此等等。

  算法的时间复杂度为O（$n^2$）
  [Dijkstra算法解释][2]

    Initialization:
        N' = {U}
        for all nodes V
        if v is a neighbor of u
            then D(v) = c(u,v)
        else D(v) = ∞
    Loop:
        find w in N' such that D(w) is a minimum
        addd w to N'
        update D(v) for each neighbor v of w and not in N':
            D(v) = min(D(v), D(w) + c(w,v))
        least path cost to w plus cost from w to v
      until N' = N

OSPF使用的就是LS算法

>**DV算法**：迭代的、异步的和分布式的算法。(Bellaman-Ford方程：$d_x(y) = min_v\{ c(x,y) + d_v(y) \}$)

    Initalization:
        for all destinations y in N:
            D[x](y) = c(x,y)
        for each neighbor w
            D[w](y) = ?for all destinations y in N
        for each neighbor w
            send distance vector D[x] = [D[x](y):y in N] to w
    loop
        wait (until I see a link cost change to some neighbor w or until I receive a distance vector from some neighbor w)
        for each y in N:
            D[x](y) = min[v]{c(x,y)+D[v](y)}
        
        if D[x](y) changed for any destination y
            send distance vector D[x] = [D[x](y):y in N] to all neighbors
    forever
>**对于DV算法的改进**：增加毒性逆转，如果z通过y路由选择到目的地x，则z将通告y，它到x的距离为∞，只要z经过y路由选择到x，z就持续性地这样说。
>
>DV算法的应用：RIP，BGP（使用的是路径向量，是变种）

---

###**层次路由选择**：
将路由器组织进自治系统（AS）来解决。AS内部之间使用RIP和OSPF，AS之间使用BGP。
>**路由选择协议（RIP）**：每台路由器维护一张路由选择表的RIP表，包括该路由器的距离向量和该路由器的转发表。

>**开放最短路优先（OSPF）**：核心为一个使用洪泛链路状态信息的链路状态协议和一个Dijkstra最低费用路径算法。（优点：1.安全 2.多条相同费用的路径 3.对单播与多播路由选择的综合支持 4.支持在单个路由选择域内的层次支持）

>**BGP**：分为iBGP和eBGP。在BGP中，一个自治系统由其全局唯一的*自制系统号*（**ASN**）所标识。
>>AS-PATH：该属性包含了前缀的通告已经通过的那些AS，当一个前缀传送到一个AS时，该AS将他的ASN增加到AS-PATH属性中
>>NEXT-HOP：是一个开始某AS-PATH的路由器接口。

>为什么要使用不同AS间和AS内部路由选择协议？
1. 策略：在AS之间，起主导作用
2. 规模
3. 性能

---

### **选择路由参数**

1. 路径长度
2. 可靠性
3. 延迟
4. 带宽
5. 负载
6. 通信代价

---

### **子网掩码的作用**

子网掩码是一个32位地址，是与IP地址结合使用的一种技术。它的主要作用有两个，一是用于屏蔽IP地址的一部分以区别网络标识和主机标识，并说明该IP地址是在局域网上，还是在远程网上。二是用于将一个大的IP网络划分为若干小的子网络。

---

### **ARP**

地址解析协议

作用：将一个IP地址解析为MAC地址

向他的适配器发送一个具有目标IP地址，自己IP地址，自己MAC地址的特殊报文，适配器将该报文传入子网，广播地址作为帧的目的地址。子网中的每个适配器都会收到该报文，然后检查它的IP地址是否为目的IP地址，是的那个将发送ARP响应分组。

---

### **拥塞控制**

网络拥塞控制的基本方法：

1. 缓冲区预分配法
2. 分组丢弃法（这里还分为葡萄酒，牛奶和优先级三种丢弃方法）
3. 定额控制法

---

### **子网划分**

已知掩码，求子网数量

eg：给定C类地址，子网掩码为255.255.255.224那么子网数量就是$2^3-2 = 6$个，000代表网络本身，111代表广播

---

### **IPV4与IPV6的区别**

1. 扩展了路由和寻址的能力
2. 报头格式的简化
3. 对可选项更大的支持
4. 流的支持
5. 身份验证和保密

---

### **IP地址划分**

A类IP段　1.0.0.0 到126.255.255.255 (0段和127段不使用)
B类IP段　128.0.0.0 到191.255.255.255
C类IP段　192.0.0.0 到223.255.255.255

## 第五章 链路层

链路层协议能够提供的可能服务包括：1. 成帧 2.链路接入 3.可靠交付 4.差错检测和纠正

---

###**传输数据中检查差错的3种技术**：
奇偶效验，检验和方法（应用于传输层），CRC检测（应用在适配器中的链路层）
>**奇偶效验**：d个比特的数据之后，附加一个比特位，选择他的值使得数据中1的值总为偶数。
>对于其改进之后使用二维奇偶效验方案，使用矩阵来进行纠错。校验比特本身的单个比特错误也是可检测和纠正的。二维奇偶效验也能够检测（不能纠正！）一个分组中两个比特差错的任何组合。
>**CRC**：提前协商好r+1的比特模式。对于一个给定的数据段D，发送方要选择r个附加比特R，并将他们附加到D上，使得到的d+r位比特模式用模2算数恰好能被G整除。

---

###多路访问协议划分为3种：
**信道划分协议**，**随机接入协议**，**轮流协议**

---

###**随机接入协议**：
ALOHA协议和CSMA协议

>**纯ALOHA**：发送，直到在规定时间内收到应答。
>
>**时隙ALOHA**：一个给定结点成功传输一次的概率为：$p(1-p)^{2(N-1)}$,纯ALOHA协议的最大效率仅为1/（2e）

>**CSMA/CD**：改进版CSMA
>CSMA：在传输数据之前，先监听一段时间信道，如果一小段时间没有传输然后才开始传输。在传输的时候一直监听信道，如果检测到另一个结点正在传输数据，则停止传输，重复开始。
>
>坚持型CSMA：监听信道，直到空闲才发送，如果发生冲突，随机等待一定时间再次发送。
>
>非坚持型CSMA：监听信道，若信道空闲发送，如果信道忙，随机等待一定时间再发送，如果发生冲突，随机等到一定时间再发送。
>
>p坚持型CSMA：监听信道，如果信道空闲，则p的概率发送，1-p的几率等待下一时间再发送，如果信道忙，则等待下一瞬间再发送，如果产生冲突，则随机等待一定时间再发送。
1. 适配器从网络层一条获得数据报，准备链路层帧，并将其放入帧适配器缓存中。
2. 如果适配器监听到信道空闲（即无信号能量从信道进入适配器），它开始传输帧。在另一方面，如果适配器监听到信道正在忙，它将等待，直到监听到没有信号能量才开始传输帧。
3. 在传输过程中，适配器监视来自其他使用该广播信道的适配器的信号能量的存在。
4. 如果适配器传输整个帧而未检测到来自其他适配器的信号能量，该适配器就完成了该帧。在另一方面，如果适配器在传输的时候检测到来自其他的适配器的信号能量，他就终止传输。
5. 终止传输后，适配器等待一个随机时间量，然后返回步骤2。

---

###CSMA/CD的效率公式：
$$效率 = \frac{1}{1+5d_{prop}/d_{trans}}$$

---

###**轮流协议**：
一种为轮询协议，一种为令牌传递协议

---

###**交换局域网**：
>**链路层寻址（ARP）**：在发送主机中的ARP模块将取在相同局域网上的任何IP地址作为输入，然后返回相应的MAC地址。

---

###**以太网**：
链路层交换机：过滤是决定一个帧应该转发到某个接口还是应将其丢弃的交换机的功能，转发是决定一个帧应该被导向哪个接口，并把该帧移动到那些接口的交换机功能。其都借助于交换机表完成。
*性质*：1. 消除碰撞 2. 异质的链路 3. 管理

>**交换机和路由器的比较**：
>交换机是即插即用的，还具有相对高的分组过滤和转发速率，但对于广播风暴并不提供任何保护措施。
>路由器在网络中存在冗余路径时，分组也不会通过路由器循环。因为没有生成树的限制，可以以丰富的拓扑结构构建因特网，并且对第二层的广播风暴提供了防火墙保护。

---

### **透明传输**

透明传输是指不管所传数据是什么样的比特组合，都应当能够在链路上传送。

‘0’比特插入法：在出现5个1的时候插入一个0

---

### **海明码差错检验**

两个码字中不相同的位的个数称为海明距离。

为了可靠地检测d 个错误，需要一个距离为d+l 的编码方案

为了纠正d 个错误，需要一个距离为2d的编码方案

$2^k\geq n+k+1$ 新增添的检测位数k需要满足

在海明码中，码字的位被连续编号， 从最左端的位开始， 紧跟在右边的那位是2，依次从左到右编号。2 的幕次方的位(1 ,2，4，8, 16 等）是校验位， 其余位(3, 5, 6, 7, 9 等〉用来填充m 个数据位。

| **信息码位数** | **1** | **2~4** | **5~11** | **12~26** |
| --------- | ----- | ------- | -------- | --------- |
| **校验码位数** | **2** | **3**   | **4**    | **5**     |

然后每一位分管一组，使该组的效验和为0

$C_1$：1，3，5，7，9，11

$C_2$：2，3，6，7，10，11，14，15

$C_4$：4，5，6，7，12，13，14，15

$C_8$：8，9，10，11，12，13，14，15，24

计算出来之后，在接收方使用这些组进行检验位的计算，然后检验位组成的二进制数如果有奇数，其十进制的值就是出错的位数。

---

### **帧序号，确认号，效验码**

帧序号确定IP包的序列号，用于拼接

确认号用于表示是否完毕，后面是否还有

效验码用来纠错验错

---

### **交换机和网桥的区别**

1. 交换机工作时，实际上允许许多组端口间的通道同时工作。所以，交换机的功能体现出不仅仅是一个网桥的功能，而是多个网桥功能的集合。即网桥一般分有两个端口，而交换机具有高密度的端口。 
2. 由于交换机能够支持多个端口，因此可以把网络系统划分成为更多的物理网段，这样使得整个网络系统具有更高的带宽。而网桥仅仅支持两个端口，所以，网桥划分的物理网段是相当有限的。
3. 交换机与网桥数据信息的传输速率相比，交换机要快于网桥。
4. 网桥在发送数据帧前，通常要接收到完整的数据帧并执行帧检测序列FCS后，才开始转发该数据帧。交换机具有存储转发和直接转发两种帧转发方式。直接转发方式在发送数据以前，不需要在接收完整个数据帧和经过32bit循环冗余校验码CRC的计算检查后的等待时间。

---

### **虚电路与数据报**

| 对比的方面        | 虚电路                     | 数据报                        |
| :----------- | ----------------------- | -------------------------- |
| **连接的建立**    | 必须有                     | 不要                         |
| **目的站地址**    | 仅在连接建立阶段使用，每个分组使用短的虚电路号 | 每个分组都有目的站的全地址              |
| **路由选择**     | 在虚电路连接建立时进行，所有分组均按同一路由  | 每个分组独立选择路由                 |
| **当路由器出故障**  | 所有通过了出故障的路由器的虚电路均不能工作   | 出故障的路由器可能会丢失分组，一些路由可能会发生变化 |
| **分组的顺序**    | 总是按发送顺序到达目的站            | 到达目的站时可能不按发送顺序             |
| **端到端的差错处理** | 由通信子网负责                 | 由主机负责                      |
| **端到端的流量控制** | 由通信子网负责                 | 由主机负责                      |

## 第六章 物理层

###**尼奎斯特定理**：
$ 最大数据速率 = 2Blog_2V(比特/秒) $

---

###**信噪比**：
信号功率记做S，噪声功率记做N，信噪比为S/N，对数形式为$ 10log_{10}S/N $，单位为分贝

---

###**香农的成果**：
$ 最大比特率 = Blog_2 (1+S/N) $

---


###**多路复用**：
频分复用，时分复用，码分复用

---

###**T1**：
T1载波是美国、加拿大、日本和新加坡的标准载波，他把24路语音信息按**时分多路**的原理复合在一条1.544Mb/s的高速信道上。

---

###**E1**：
E1载波是一种2.048Mbps速率的PCM载波，采用**同步时分复用**技术，将三十个语音信息（64kb）和两个控制信道（16kb）复合在一条2.048Mb/s的高速信道上。

---

###**IP效验和方法**：
IP头部以16位为一个单位，逐个模2加（异或），将得到的结果取反，作为效验和放入检验和字段（初始检验和字段全部用0填充）

---

### **数字信号优点**

便于加密处理

便于储存处理和交换

便于集成化、微型

便于构成综合数字网和综合业务数字网

占用信道频带较宽

---

### **ADSL**

是以电话线作传输介质，采用**频分复用**技术将电话音与数据流分开

---

### **传输介质**

双绞铜线：电话网

同轴电缆：电缆电视系统

光纤：长途电话网，因特网的主干

陆地无线电信道：蜂窝接入技术

卫星无线电信道：无法使用DSL或电缆因特网接入的地区

---

### **分组交换与电话报**

电话：电路建立时间+发送时间+传播时间

分组：发送时间+传播时间+中间k-1跳传输时间

---

### **最小帧计算**

传输时延 > 2* 最远两个站点间传播时延 ①
传输时延 = 数据包大小/数据包发送速率  ②
传播时延 = 站点间距离/信号传播速率 ③

### 















[1]: http://blog.csdn.net/ns_code/article/details/29382883
[2]: http://www.cnblogs.com/biyeymyhjob/archive/2012/07/31/2615833.html